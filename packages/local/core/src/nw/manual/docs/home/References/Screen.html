<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <html>Screen</html>
  <meta name="generator" content="Haroopad 0.13.2" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../asset/clearness-dark.css"></head>
</head>
<body class="markdown clearness-dark">
<h1 id="screen"><a name="screen" href="#screen"></a>Screen</h1><hr class="section"><div class="toc"><ul>
<li><ul>
<li><span class="html">
<a href="#synopsis" html="Synopsis">Synopsis</a>
</span>
<!--span class="number">
0
</span-->
</li>
<li><span class="html">
<a href="#screen.init()" html="Screen.Init()">Screen.Init()</a>
</span>
<!--span class="number">
1
</span-->
</li>
<li><span class="html">
<a href="#screen.screens" html="Screen.screens">Screen.screens</a>
</span>
<!--span class="number">
2
</span-->
</li>
<li><span class="html">
<a href="#screen.choosedesktopmedia-(sources,-callback)" html="Screen.chooseDesktopMedia (sources, callback)">Screen.chooseDesktopMedia (sources, callback)</a>
</span>
<!--span class="number">
3
</span-->
</li>
<li><span class="html">
<a href="#event:-displayboundschanged(screen)" html="Event: displayBoundsChanged(screen)">Event: displayBoundsChanged(screen)</a>
</span>
<!--span class="number">
4
</span-->
</li>
<li><span class="html">
<a href="#event:-displayadded-(screen)" html="Event: displayAdded (screen)">Event: displayAdded (screen)</a>
</span>
<!--span class="number">
5
</span-->
</li>
<li><span class="html">
<a href="#event:-displayremoved-(screen)" html="Event: displayRemoved (screen)">Event: displayRemoved (screen)</a>
</span>
<!--span class="number">
6
</span-->
</li>
<li><span class="html">
<a href="#screen.desktopcapturemonitor" html="Screen.DesktopCaptureMonitor">Screen.DesktopCaptureMonitor</a>
</span>
<!--span class="number">
7
</span-->
<ul>
<li><span class="html">
<a href="#synopsis-1" html="Synopsis">Synopsis</a>
</span>
<!--span class="number">
8
</span-->
</li>
<li><span class="html">
<a href="#screen.desktopcapturemonitor.started" html="Screen.DesktopCaptureMonitor.started">Screen.DesktopCaptureMonitor.started</a>
</span>
<!--span class="number">
9
</span-->
</li>
<li><span class="html">
<a href="#screen.desktopcapturemonitor.start(should_include_screens,-should_include_windows)" html="Screen.DesktopCaptureMonitor.start(should_include_screens, should_include_windows)">Screen.DesktopCaptureMonitor.start(should_include_screens, should_include_windows)</a>
</span>
<!--span class="number">
10
</span-->
</li>
<li><span class="html">
<a href="#screen.desktopcapturemonitor.stop()" html="Screen.DesktopCaptureMonitor.stop()">Screen.DesktopCaptureMonitor.stop()</a>
</span>
<!--span class="number">
11
</span-->
</li>
<li><span class="html">
<a href="#screen.desktopcapturemonitor.registerstream(id)" html="Screen.DesktopCaptureMonitor.registerStream(id)">Screen.DesktopCaptureMonitor.registerStream(id)</a>
</span>
<!--span class="number">
12
</span-->
</li>
<li><span class="html">
<a href="#event:-added-(id,-name,-order,-type,-primary)" html="Event: added (id, name, order, type, primary)">Event: added (id, name, order, type, primary)</a>
</span>
<!--span class="number">
13
</span-->
</li>
<li><span class="html">
<a href="#event:-removed-(order)" html="Event: removed (order)">Event: removed (order)</a>
</span>
<!--span class="number">
14
</span-->
</li>
<li><span class="html">
<a href="#event:-orderchanged-(id,-new_order,-old_order)" html="Event: orderchanged (id, new_order, old_order)">Event: orderchanged (id, new_order, old_order)</a>
</span>
<!--span class="number">
15
</span-->
</li>
<li><span class="html">
<a href="#event:-namechanged-(id,-name)" html="Event: namechanged (id, name)">Event: namechanged (id, name)</a>
</span>
<!--span class="number">
16
</span-->
</li>
<li><span class="html">
<a href="#event:-thumbnailchanged-(id,-thumbnail)" html="Event: thumbnailchanged (id, thumbnail)">Event: thumbnailchanged (id, thumbnail)</a>
</span>
<!--span class="number">
17
</span-->
</li>
</ul>
</li>
</ul>
</li>

</ul>
</div><p><code>Screen</code> is an instance of EventEmitter object, and you’re able to use <code>Screen.on(...)</code> to respond to native screen’s events.</p><p><code>Screen</code> is a singleton object, need to be initiated once by calling <code>nw.Screen.Init()</code></p><h2 id="synopsis"><a name="synopsis" href="#synopsis"></a>Synopsis</h2><pre class="javascript hljs"><span class="hljs-comment">//init must be called once during startup, before any function to nw.Screen can be called</span>
nw.Screen.Init();

<span class="hljs-keyword">var</span> screenCB = {
  onDisplayBoundsChanged: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">screen</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'displayBoundsChanged'</span>, screen);
  },

  onDisplayAdded: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">screen</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'displayAdded'</span>, screen);
  },

  onDisplayRemoved: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">screen</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'displayRemoved'</span>, screen)
  }
};

<span class="hljs-comment">// listen to screen events</span>
nw.Screen.on(<span class="hljs-string">'displayBoundsChanged'</span>, screenCB.onDisplayBoundsChanged);
nw.Screen.on(<span class="hljs-string">'displayAdded'</span>, screenCB.onDisplayAdded);
nw.Screen.on(<span class="hljs-string">'displayRemoved'</span>, screenCB.onDisplayRemoved);
</pre><h2 id="screen.init()"><a name="screen.init()" href="#screen.init()"></a>Screen.Init()</h2><p>Init the Screen singleton object, you only need to call this once</p><h2 id="screen.screens"><a name="screen.screens" href="#screen.screens"></a>Screen.screens</h2><p>Get the array of screen (number of screen connected to the computer)</p><p>screen has following structure:</p><pre class="javascript hljs">screen {
<span class="hljs-comment">// unique id for a screen</span>
  id: int,

<span class="hljs-comment">// physical screen resolution, can be negative, not necessarily start from 0,depending on screen arrangement</span>
  bounds: {
    x: int,
    y: int,
    width: int,
    height: int
  },

<span class="hljs-comment">// useable area within the screen bound</span>
  work_area: {
    x: int,
    y: int,
    width: int,
    height: int
  },

  scaleFactor: float,
  isBuiltIn: bool,
  rotation: int,
  touchSupport: int
}
</pre><h2 id="screen.choosedesktopmedia-(sources,-callback)"><a name="screen.choosedesktopmedia-(sources,-callback)" href="#screen.choosedesktopmedia-(sources,-callback)"></a>Screen.chooseDesktopMedia (sources, callback)</h2><ul>
<li><code>sources</code> <code>{String[]}</code> array of source types. Two types are supported by this API: <code>"screen"</code> and <code>"window"</code>.</li><li><code>callback</code> <code>{Function}</code> callback function with chosed streamId. streamId will be <code>false</code> if failed to execute or existing session is alive.</li></ul><p>!!! note<br>    Screen sharing by selection; Currently only working in Windows and OSX and some linux distribution.</p><p>Example:</p><pre class="javascript hljs">nw.Screen.Init(); <span class="hljs-comment">// you only need to call this once</span>
nw.Screen.chooseDesktopMedia([<span class="hljs-string">"window"</span>,<span class="hljs-string">"screen"</span>], 
  <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">streamId</span>) </span>{
    <span class="hljs-keyword">var</span> vid_constraint = {
      mandatory: {
        chromeMediaSource: <span class="hljs-string">'desktop'</span>, 
        chromeMediaSourceId: streamId, 
        maxWidth: <span class="hljs-number">1920</span>, 
        maxHeight: <span class="hljs-number">1080</span>
      }, 
      optional: []
    };
    navigator.webkitGetUserMedia({audio: <span class="hljs-literal">false</span>, video: vid_constraint}, success_func, fallback_func);
  }
);
</pre><h2 id="event:-displayboundschanged(screen)"><a name="event:-displayboundschanged(screen)" href="#event:-displayboundschanged(screen)"></a>Event: displayBoundsChanged(screen)</h2><p>Emitted when the screen resolution, arrangement is changed, the callback is called with 1 argument <code>screen</code>. See <a href="#screenscreens">Screen.screens</a> for the format.</p><h2 id="event:-displayadded-(screen)"><a name="event:-displayadded-(screen)" href="#event:-displayadded-(screen)"></a>Event: displayAdded (screen)</h2><p>Emitted when a new screen added, the callback is called with 1 argument <code>screen</code>. See <a href="#screenscreens">Screen.screens</a> for the format.</p><h2 id="event:-displayremoved-(screen)"><a name="event:-displayremoved-(screen)" href="#event:-displayremoved-(screen)"></a>Event: displayRemoved (screen)</h2><p>Emitted when existing screen removed, the callback is called with 1 argument <code>screen</code>. See <a href="#screenscreens">Screen.screens</a> for the format.</p><h2 id="screen.desktopcapturemonitor"><a name="screen.desktopcapturemonitor" href="#screen.desktopcapturemonitor"></a>Screen.DesktopCaptureMonitor</h2><p>This API behaves similar functions as <code>Screen.chooseDesktopMedia</code>. But it doesn’t have GUI. You can use this API to monitor the changes of screens and windows on desktop and implement your own UI.</p><p><code>Screen.DesktopCaptureMonitor</code> is an instance of <code>EventEmitter</code>. You can use <code>Screen.DesktopCaptureMonitor.on()</code> to listen to the events.</p><h3 id="synopsis"><a name="synopsis" href="#synopsis"></a>Synopsis</h3><pre class="javascript hljs"><span class="hljs-keyword">var</span> dcm = nw.Screen.DesktopCaptureMonitor;
nw.Screen.Init();
dcm.on(<span class="hljs-string">"added"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id, name, order, type</span>) </span>{
   <span class="hljs-comment">//select first stream and shutdown</span>
   <span class="hljs-keyword">var</span> constraints = {
      audio: {
         mandatory: {
             chromeMediaSource: <span class="hljs-string">"system"</span>,
             chromeMediaSourceId: dcm.registerStream(id)
          }
      },
      video: {
         mandatory: {
             chromeMediaSource: <span class="hljs-string">'desktop'</span>,
             chromeMediaSourceId: dcm.registerStream(id)
         }
      }
  };

  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> call getUserMedia with contraints</span>

  dcm.stop();
});

dcm.on(<span class="hljs-string">"removed"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id</span>) </span>{ });
dcm.on(<span class="hljs-string">"orderchanged"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id, new_order, old_order</span>) </span>{ });
dcm.on(<span class="hljs-string">"namechanged"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id, name</span>) </span>{ });
dcm.on(<span class="hljs-string">"thumbnailchanged"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id, thumbnail</span>) </span>{ });
dcm.start(<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);
</pre><h3 id="screen.desktopcapturemonitor.started"><a name="screen.desktopcapturemonitor.started" href="#screen.desktopcapturemonitor.started"></a>Screen.DesktopCaptureMonitor.started</h3><p>Boolean of whether the DesktopCaptureMonitor is started.</p><h3 id="screen.desktopcapturemonitor.start(should_include_screens,-should_include_windows)"><a name="screen.desktopcapturemonitor.start(should_include_screens,-should_include_windows)" href="#screen.desktopcapturemonitor.start(should_include_screens,-should_include_windows)"></a>Screen.DesktopCaptureMonitor.start(should_include_screens, should_include_windows)</h3><ul>
<li><code>should_include_screens</code> <code>{Boolean}</code> whether should include screens</li><li><code>should_include_windows</code> <code>{Boolean}</code> whether should include windows</li></ul><p>The <code>DesktopCaptureMonitor</code> will start monitoring the system and trigger the the events. The screen may flicker if while <code>DesktopCaptureMonitor</code> is running.</p><h3 id="screen.desktopcapturemonitor.stop()"><a name="screen.desktopcapturemonitor.stop()" href="#screen.desktopcapturemonitor.stop()"></a>Screen.DesktopCaptureMonitor.stop()</h3><p>The <code>DesktopCaptureMonitor</code> will stop monitoring the system. <code>DesktopCaptureMonitor</code> should be stopped after a stream is selected.</p><h3 id="screen.desktopcapturemonitor.registerstream(id)"><a name="screen.desktopcapturemonitor.registerstream(id)" href="#screen.desktopcapturemonitor.registerstream(id)"></a>Screen.DesktopCaptureMonitor.registerStream(id)</h3><p>Register and return a valid stream id passed into <code>chromeMediaSourceId</code> in <code>getUserMedia</code> constraints. See <a href="#synopsis_1">Synopsis</a> for the usage.</p><h3 id="event:-added-(id,-name,-order,-type,-primary)"><a name="event:-added-(id,-name,-order,-type,-primary)" href="#event:-added-(id,-name,-order,-type,-primary)"></a>Event: added (id, name, order, type, primary)</h3><p>!!! warning “Behavior Changed”<br>    This feature is changed in 0.13.0. See <a href="../For Users/Migration/From 0.12 to 0.13.html">Migration Notes from 0.12 to 0.13</a>.</p><ul>
<li><code>id</code> <code>{String}</code> is the media id. Use <code>registerStream(id)</code> to obtain a valid stream id used with <code>getUserMedia()</code>. See <a href="#screendesktopcapturemonitorregisterstreamid">registerStream</a></li><li><code>name</code> <code>{String}</code> is the html of the window or screen</li><li><code>order</code> <code>{Integer}</code> is the z-order of the windows, if screens are selected they will appear first</li><li><code>type</code> <code>{String}</code> type of the stream: “screen”, “window”, “other” or “unknown”</li><li><code>primary</code> <code>{Boolean}</code> <em>Windows OS only</em> this will be <code>true</code> if the source is the primary monitor</li></ul><p>Emit when a new source was added.</p><h3 id="event:-removed-(order)"><a name="event:-removed-(order)" href="#event:-removed-(order)"></a>Event: removed (order)</h3><ul>
<li><code>order</code> <code>{Integer}</code> is the order of the media source that is no longer capturable</li></ul><p>Emit when a source was removed.</p><h3 id="event:-orderchanged-(id,-new_order,-old_order)"><a name="event:-orderchanged-(id,-new_order,-old_order)" href="#event:-orderchanged-(id,-new_order,-old_order)"></a>Event: orderchanged (id, new_order, old_order)</h3><p>!!! warning “Behavior Changed”<br>    This feature is changed in 0.13.0. See <a href="../For Users/Migration/From 0.12 to 0.13.html">Migration Notes from 0.12 to 0.13</a>.</p><ul>
<li><code>id</code> <code>{String}</code> is the media id of the screen or window that has changed z-order</li><li><code>new_order</code> <code>{Integer}</code> is the new z-order</li><li><code>old_order</code> <code>{Integer}</code> is the old z-order</li></ul><p>Emit when the Z-order of a source changed (this may change for windows as others are focused).</p><h3 id="event:-namechanged-(id,-name)"><a name="event:-namechanged-(id,-name)" href="#event:-namechanged-(id,-name)"></a>Event: namechanged (id, name)</h3><p>!!! warning “Behavior Changed”<br>    This feature is changed in 0.13.0. See <a href="../For Users/Migration/From 0.12 to 0.13.html">Migration Notes from 0.12 to 0.13</a>.</p><ul>
<li><code>id</code> <code>{String}</code> is the media id of the screen or window that has a name changed</li><li><code>name</code> <code>{String}</code> is the new name of the screen or window</li></ul><p>Emit when the name of the source has changed. This can happen when a window changes html.</p><h3 id="event:-thumbnailchanged-(id,-thumbnail)"><a name="event:-thumbnailchanged-(id,-thumbnail)" href="#event:-thumbnailchanged-(id,-thumbnail)"></a>Event: thumbnailchanged (id, thumbnail)</h3><p>!!! warning “Behavior Changed”<br>    This feature is changed in 0.13.0. See <a href="../For Users/Migration/From 0.12 to 0.13.html">Migration Notes from 0.12 to 0.13</a>.</p><ul>
<li><code>id</code> <code>{String}</code> is the media id of the screen or window that has an updated thumbnail</li><li><code>thumbnail</code> <code>{String}</code> is the base64 encoded png of the thumbnail</li></ul><p>Emit when the thumbnail of a source changed.</p>


</body>
</html>
