<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <html>Protect JavaScript Source Code</html>
  <meta name="generator" content="Haroopad 0.13.2" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../../asset/clearness-dark.css"></head>
</head>
<body class="markdown clearness-dark">
<h1 id="protect-javascript-source-code"><a name="protect-javascript-source-code" href="#protect-javascript-source-code"></a>Protect JavaScript Source Code</h1><hr class="section"><div class="toc"><ul>
<li><ul>
<li><ul>
<li><span class="html">
<a href="#compilation" html="Compilation">Compilation</a>
</span>
<!--span class="number">
0
</span-->
</li>
<li><span class="html">
<a href="#load-the-compiled-javascript" html="Load the Compiled JavaScript">Load the Compiled JavaScript</a>
</span>
<!--span class="number">
1
</span-->
</li>
<li><span class="html">
<a href="#load-compiled-javascript-from-remote" html="Load Compiled JavaScript from Remote">Load Compiled JavaScript from Remote</a>
</span>
<!--span class="number">
2
</span-->
</li>
<li><span class="html">
<a href="#use-in-web-workers" html="Use in Web Workers">Use in Web Workers</a>
</span>
<!--span class="number">
3
</span-->
</li>
<li><span class="html">
<a href="#known-issues" html="Known Issues">Known Issues</a>
</span>
<!--span class="number">
4
</span-->
</li>
</ul>
</li>
</ul>
</li>

</ul>
</div><p>The JavaScript source code of your application can be protected by compiling to native code and loaded by NW.js. You only have to distribute the compiled code with your app for production.</p><h3 id="compilation"><a name="compilation" href="#compilation"></a>Compilation</h3><p>JS source code is compiled to native code with the tool <code>nwjc</code> , which is provided in the SDK build.</p><p>To use it:</p><pre class="bash hljs">nwjc source.js binary.bin
</pre><p>The <code>*.bin</code> file is needed to be distributed with your application. You can name it whatever you want.</p><p>If you are compiling a module, <code>--nw-module</code> argument is needed.</p><h3 id="load-the-compiled-javascript"><a name="load-the-compiled-javascript" href="#load-the-compiled-javascript"></a>Load the Compiled JavaScript</h3><pre class="javascript hljs">nw.Window.get().evalNWBin(frame, <span class="hljs-string">'binary.bin'</span>);
</pre><p>The arguments of the <a href="../../References/Window.html#winevalnwbinframe-path">win.evalNWBin()</a> method are similar with the <code>Window.eval()</code> method, where the first parameter is the target iframe (<code>null</code> for main frame), and the 2nd parameter is the binary code file.</p><p>If you are loading binary for modules, <a href="../../References/Window.html#winevalnwbinmoduleframe-path-module_path">win.evalNWBinModule()</a> should be used instead.</p><h3 id="load-compiled-javascript-from-remote"><a name="load-compiled-javascript-from-remote" href="#load-compiled-javascript-from-remote"></a>Load Compiled JavaScript from Remote</h3><p>Compiled JavaScript can be fetched from remote (e.g. with AJAX) and executed on the fly.</p><pre class="javascript hljs"><span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();
xhr.responseType = <span class="hljs-string">'arraybuffer'</span>; <span class="hljs-comment">// make response as ArrayBuffer</span>
xhr.open(<span class="hljs-string">'GET'</span>, url, <span class="hljs-literal">true</span>);
xhr.send();
xhr.onload = () =&gt; {
  <span class="hljs-comment">// xhr.response contains compiled JavaScript as ArrayBuffer</span>
  nw.Window.get().evalNWBin(<span class="hljs-literal">null</span>, xhr.response);
}
</pre><p>!!! note<br>    The compiled code is executed in <a href="JavaScript Contexts in NW.js.html#browser-context">Browser Context</a>. You can use any Web APIs (such as DOM) and <a href="JavaScript Contexts in NW.js.html#access-nodejs-and-nwjs-api-in-browser-context">access NW.js API and Node API</a> like other scripts running in browser context.</p><h3 id="use-in-web-workers"><a name="use-in-web-workers" href="#use-in-web-workers"></a>Use in Web Workers</h3><p>A function <code>importNWBin(ArrayBuffer)</code> is introduced in worker context. The binary file can be read to array buffer in the main thread, posted to worker and then executed there with the new function.</p><h3 id="known-issues"><a name="known-issues" href="#known-issues"></a>Known Issues</h3><p>Before 0.22, the compiled code runs <strong>slower than normal JS</strong>: ~30% performance according to v8bench. Other non-compiled JS source code will not be affected. In 0.22.0-beta1, this issue has been fixed. Please check our blog post: <a href="https://nwjs.io/blog/js-src-protect-perf/">https://nwjs.io/blog/js-src-protect-perf/</a></p><p>The compiled code is <strong>not cross-platform nor compatible between versions</strong> of NW.js. So youâ€™ll need to run <code>nwjc</code> for each of the platforms when you package your application.</p>


</body>
</html>
