<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>How-to-package-and-distribute-your-apps.html</title>
  <meta name="generator" content="Haroopad 0.13.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="../asset/clearness-dark.css" rel="stylesheet">
</head>
<body class="markdown clearness-dark">
<p><strong>NOTE: some content in this wiki applies only to 0.12 and earlier versions. For official documentation on 0.13 and later, see <a href="http://docs.nwjs.io">http://docs.nwjs.io</a></strong></p><h2 id="quick-start"><a name="quick-start" href="#quick-start"></a>Quick start</h2><p>Just put the files along with NW files in the same directory and then ship them to your users.<br>nw.exe and package.json should be in the same directory.  </p><p>On OSX it’s different: put the tree of your app in a directory named <code>nwjs.app/Contents/Resources/app.nw</code>.</p><p>For more info and other ways of packaging, please read on.</p><h2 id="preparing-extra-files"><a name="preparing-extra-files" href="#preparing-extra-files"></a>Preparing extra files</h2><p>The following sub-directories can be put in application’s root directory:</p><ul>
<li><strong>node_modules</strong> - any Node modules you want to deploy with your application</li><li><strong>plugins</strong> - NPAPI plugin files</li></ul><p>You don’t need to ship the <code>nwsnapshot</code> file in the downloaded zip.</p><p><strong>Caution</strong>: do not assume your <code>node_modules</code> that target one platform work <em>as is</em> in all platforms. For instance <code>node-email-templates</code> has specific Windows &amp; Mac os x <code>npm install</code> commands. Besides, it requires python to install properly, which is not installed by default on Windows.</p><p>As a rule of thumb <code>npm install</code> your <code>package.json</code> on each platform you target to ensure everything works as expected.</p><h2 id="step-1:-make-a-package"><a name="step-1:-make-a-package" href="#step-1:-make-a-package"></a>Step 1: Make a package</h2><p><em>Since our package system is similar to <a href="https://love2d.org">LÖVE</a>, following guides are modified from its <a href="https://love2d.org/wiki/Game_Distribution">Wiki</a>.</em></p><p>An app’s package is a zip archive with <code>.nw</code> as extension. Three caveats:</p><ul>
<li>There must be a <code>package.json</code> file that describes the package, see [[Manifest format]].</li><li>The <code>package.json</code> file must be at the root of the archive. </li><li>In the <code>.nw</code>, the file and directory path names are case sensitive. This can be puzzling for Windows and Mac OS X users, whose filesystem is case insensitive, and whose apps may work when unzipped but not when packaged.</li></ul><p>Here’s how to proceed to generate a working <code>.nw</code> file:</p><h3 id="windows"><a name="windows" href="#windows"></a>Windows</h3><ol>
<li>Create a zip file (this is built into XP, Vista and 7) </li><li>Copy all of your files into the zip file, retaining directory structure and making sure that the <code>package.json</code> file is in the root directory (if you make a zip file containing a folder with your stuff in it, then it’s not going to work) </li><li>Rename the file extension from <code>.zip</code> to <code>.nw</code>. By default, file extensions may be hidden. You need to (press <code>alt</code>), go to folder options and uncheck “Hide extensions for known file types” to be able to rename the zip. </li></ol><h3 id="linux-/-os-x"><a name="linux-/-os-x" href="#linux-/-os-x"></a>Linux / OS X</h3><p>From the command line: </p><ol>
<li>Go to your project directory a la <code>cd ~/Projects/my_app</code></li><li>Run <code>zip -r ../${PWD##*/}.nw *</code></li><li>Your fully-prepared <code>.nw</code> file shall be located right outside of your project directory </li><li>Cake!</li></ol><h2 id="step-2a:-put-your-app-with-nw-executable"><a name="step-2a:-put-your-app-with-nw-executable" href="#step-2a:-put-your-app-with-nw-executable"></a>Step 2a: Put your app with nw executable</h2><ul>
<li>You can zip your files and name it <code>package.nw</code> and place it in the same directory with nw executable.</li><li>Or you can just put files of node-webkit in the same directory with your package.json and then distribute the tree. When nw executable is started it will look for package.json in the same directory. (on OSX it’s the same level directory with <code>node-webkit.app</code>). <strong>This is the recommended way if the size of your files are big.</strong></li><li><a href="https://github.com/geo8bit/nodebob">nodebob</a> is a build tool for node-webkit that automates a release of your node-webkit application in windows environment. Currently in v0.1, written in windows batch script.</li><li><a href="https://github.com/evshiron/nwjs-builder-phoenix">nwjs-builder-phoenix</a>, <a href="https://github.com/nwjs/nw-builder">nw-builder</a> &amp; <a href="https://github.com/nwjs/grunt-nw-builder">grunt-nw-builder</a> Lets you build your node-webkit apps for mac, win and linux with grunt. They will download the prebuilt binaries for a specific version, unpacks it, creates a release folder, creates the app.nw file for a specified directory and copies the app.nw file to where it belongs</li><li><a href="http://codeb.it/nuwk/">Nuwk!</a> Nuwk! makes it easy to create Mac Applications based on node-webkit, simplifying testing and building procedures. It takes care of creating the executable, attaching the app icon and configuring the plist file accordingly. (very alpha stage)</li><li><a href="https://www.npmjs.org/package/generator-node-webkit">generator-node-webkit</a> is a yeoman generator to develop node-webkit applications and create packages for mac, linux and win.</li><li><a href="https://github.com/wilkerlucio/lein-node-webkit-build">lein-node-webkit-builder</a> It’s similar to <code>grunt-node-webkit-builder</code>, will download the binaries automatically and let you build on multi-platforms, but it runs as a <a href="http://leiningen.org/">Leiningen</a> plugin, more suitable for people working with <a href="https://github.com/clojure/clojurescript">ClojureScript</a>.</li><li><a href="https://github.com/jyapayne/Web2Executable">Web2Executable</a> It’s a full, cross-platform, opensource GUI packaging app that makes a single binary out of the web app, ready to use out of the box. It massively simplifies packaging apps and works with the Phaser game library. Works on Mac OSX, Linux and Windows using Pyside. It’s in beta, so feedback and contributors are very welcome.</li><li><a href="https://github.com/Gisto/nwjs-shell-builder">nwjs-shell-builder</a> - nwjs shell script builder for nwjs (node-webkit) applications. This script can be easily integrated into your build process, it will download nwjs 32/64bit for Linux, Windows and OSX and build packages for all 3 platforms from given source directory.</li></ul><h2 id="step-2b:-alternative-way---making-an-executable-file-out-of-a-.nw-file"><a name="step-2b:-alternative-way---making-an-executable-file-out-of-a-.nw-file" href="#step-2b:-alternative-way---making-an-executable-file-out-of-a-.nw-file"></a>Step 2b: Alternative way - Making an executable file out of a .nw file</h2><p>Many people are (understandably) concerned about what end-users need to do in order to run an app. If users receive a <code>.nw</code> alone, they will naturally need <code>nw</code> installed (or at least unzipped) in order to run it. But, with <code>nw</code>, you can merge the <code>.nw</code> file with the <code>nw</code> executable. </p><p>In general, it’s recommended to offer a <code>.nw</code> for download, and optionally “merged” versions for the platforms where this makes things simpler. </p><p>Two things should be noted: </p><ul>
<li>The end result will not be a single executable, you must also include some DLLs in your zip-file. </li><li>The resulting executable from the merge will still be readable by archiving software, such as WinZip.</li></ul><h3 id="windows"><a name="windows" href="#windows"></a>Windows</h3><p>Here’s how to do it on Windows. In a console, type this: </p><pre><code data-origin="<pre><code>copy /b nw.exe+app.nw app.exe 
</code></pre>">copy /b nw.exe+app.nw app.exe 
</code></pre><p>Then, all you have to do is zip app.exe and required DLLs, and distribute them. Yes; this does mean that the app will have a private copy of <code>nw</code>, but there’s nothing wrong with that. It also means that you will have to create one package for each platform you would like to support, or simply offer the <code>.nw</code> alone for the other platforms. </p><p>And please also note that the <code>nw.pak</code> must also be distributed along with the <code>app.exe</code>.</p><p><strong>Important note</strong>: if you are using native modules, your <code>.exe</code> file shall be named <code>nw.exe</code> as detailed in <a href="https://github.com/rogerwang/node-webkit/wiki/Using-Node-modules">Using Node modules</a>. Additional information is available at <a href="https://github.com/rogerwang/node-webkit/issues/199">#199</a>.</p><h3 id="linux"><a name="linux" href="#linux"></a>Linux</h3><p>On Linux, it’s similar: </p><pre><code data-origin="<pre><code>cat `which nw` app.nw &amp;gt; app &amp;amp;&amp;amp; chmod +x app 
</code></pre>">cat `which nw` app.nw &gt; app &amp;&amp; chmod +x app 
</code></pre><p>Then, you’ll have to make a package for various packaging systems with dependencies as the <code>nw</code> package. Were you to make a .deb package this way, for instance, the user would not have to install the <code>nw</code> package separately. </p><p>And please note that the <code>nw.pak</code> file must also be in the same directory with the <code>app</code> file, otherwise you would expect blank page for some features.</p><p>Eventually, we will provide scripts which do this automatically for various package systems. You’ll have to figure it out yourself until then. </p><h3 id="mac-os-x"><a name="mac-os-x" href="#mac-os-x"></a>Mac OS X</h3><p><em>Following guides apply to nw &gt;= 0.2.4</em></p><p>On OS X, the <code>node-webkit.app</code> is a directory that can be easily changed. To make nw automatically open your app, you need to put your app file under <code>Contents/Resources</code> and name it <code>app.nw</code>. The bonus over other platforms is that <code>app.nw</code> does not need to be a zip file, if you want to speed up startup, you can make <code>app.nw</code> your app’s directory.</p><p>And you need to modify following files to make a real distribution of yours:</p><ul>
<li><code>Contents/Resources/nw.icns</code>: icon of your app.</li><li><code>Contents/Info.plist</code>: the apple package description file.</li></ul><p>About the <code>Info.plist</code> file, you can view <a href="http://cocoadevcentral.com/articles/000071.php">Implementing Cocoa’s Standard About Panel</a> on how this file will influence your app and what fields you should modify.</p><h2 id="which-files-should-be-shipped?"><a name="which-files-should-be-shipped?" href="#which-files-should-be-shipped?"></a>Which files should be shipped?</h2><p><strong>Starting from v0.10.0, <code>icudtl.dat</code> need to be shipped on all the 3 platforms, and <code>icudt.dll</code> is not needed anymore.</strong></p><p>Apart from the binary files, there’re some other files you should also ship, see instructions for different platforms below. </p><p>And since the binary is based on Chromium, multiple open source license notices are needed including the MIT License, the LGPL, the BSD, the Ms-PL and an MPL/GPL/LGPL tri-license. <em>(This doesn’t apply to your code and you don’t have to open source your code)</em></p><h3 id="windows"><a name="windows" href="#windows"></a>Windows</h3><p>The <code>nw.pak</code> and <code>icudt.dll</code> must be shipped along with <code>nw.exe</code>, the former one contains important javascript lib files, and the latter one is a important network library.</p><p><code>ffmpegsumo.dll</code> are media library, if you want to use <code>&lt;video&gt;</code> and <code>&lt;audio&gt;</code> tag, or other media related features, you should ship it.</p><p><code>libEGL.dll</code> and <code>libGLESv2.dll</code> are used for WebGL and GPU acceleration, you had better ship them. And <code>D3DCompiler_43.dll</code> and <code>d3dx9_43.dll</code> as well if you want to make sure WebGL works on more hardware. These 2 files are from DirectX redistributable.</p><h3 id="linux"><a name="linux" href="#linux"></a>Linux</h3><p><code>nw.pak</code> must be shipped with <code>nw</code>. If you want media features, also ship <code>libffmpeg.so</code>.</p><h3 id="mac-os-x"><a name="mac-os-x" href="#mac-os-x"></a>Mac OS X</h3><p>Just ship the <code>node-webkit.app</code> would be fine, you don’t need to care for other things.</p><h2 id="an-alternative-way-to-make-an-executable-file-in-windows"><a name="an-alternative-way-to-make-an-executable-file-in-windows" href="#an-alternative-way-to-make-an-executable-file-in-windows"></a>An alternative way to make an executable file in Windows</h2><p>After packaging <code>app.nw</code> into <code>nw.exe</code> in the above way, you still have to ship <code>app.exe</code> with <code>nw.pak</code> and some <code>*.dll</code> files to the end users. It’s still possible to improve the result.</p><p><a href="http://enigmaprotector.com/en/aboutvb.html">Enigma Virtual Box</a> is a software that ‘enables application files and registry to be consolidated in a single executable file’. It’s <a href="http://forum.enigmaprotector.com/viewtopic.php?f=20&amp;t=5334">free</a> for personal and commercial use. </p><p><strong>Attention</strong>! “Enigma Virtual Box” and all accompanying files are licensed “AS IS” without warranties as to performance or merchantability or any other warranties whether expressed or implied. <strong>You use this way at your own risk!</strong> There may or may not be some issues with the program generated.</p><ol>
<li><a href="http://enigmaprotector.com/assets/files/enigmavb.exe">Download</a> and install the software. </li><li>Open ‘Enigma Virtual Box’ from start menu or the program folder.</li><li>Browse and choose the <code>app.exe</code> main program file in the <code>Enter Input File Name</code> blank.</li><li>Drag (or use the ‘add’ button to select and add) all the other <code>*.dll</code> files and <code>nw.pak</code> into the ‘Files’ blank. When the ‘Select Folder’ panel alerts, choose ‘%DEFAULT FOLDER’ (the default value in fact) and press ‘OK’ button.</li><li>Press ‘File Options’, choose ‘Compress Files’, and ‘OK’ if you like.</li><li>Some other configures if you know what you are doing.</li><li>Press the big ‘Process’ button in the main panel.</li><li>After all things done, you can press ‘Close’ and exit Enigma Virtual Box.</li><li>There should be a new <code>app_boxed.exe</code> in the program folder now.</li></ol><p>Now you can move and distribute the single <code>app_boxed.exe</code> to anywhere, without any <code>nw.pak</code> and <code>*.dll</code> files.</p><p>Alternatively, for batch bundling, there is also a small Node integration module<br><a href="https://www.npmjs.org/package/enigmavirtualbox">enigmavirtualbox</a>. It<br>even automatically downloads and locally unpacks the Enigma Virtual Box<br>distribution. For this, install Node and NPM and run in your Windows<br>terminal:</p><ol>
<li><code>npm install -g enigmavirtualbox</code></li><li><code>enigmavirtualbox gen app.evp app_boxed.exe app.exe nw.pak icudtl.dat ffmpegsumo.dll libEGL.dll libGLESv2.dll</code> (generate configuration)</li><li><code>enigmavirtualbox gui app.evp</code> (optionally post-edit configuration)</li><li><code>enigmavirtualbox cli app.evp</code> (execute bundling process in batch)</li></ol><p>The generated configuration file <code>app.evp</code> can be stored so you<br>can repeat step (4) arbitrary times.</p><h2 id="setup-on-windows"><a name="setup-on-windows" href="#setup-on-windows"></a>Setup on Windows</h2><p>Instead of packaging your app in one exe file, you can create a setup which contains all necessary files. A free software for easily creating setups is Inno Setup: <a href="http://www.jrsoftware.org/isinfo.php">http://www.jrsoftware.org/isinfo.php</a></p><p>An example for a setup configuration can be found here: <a href="https://github.com/SSilence/sum/blob/master/setup.iss">https://github.com/SSilence/sum/blob/master/setup.iss</a></p>


</body>
</html>
