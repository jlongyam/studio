<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>File-dialogs.html</title>
  <meta name="generator" content="Haroopad 0.13.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="../asset/clearness-dark.css" rel="stylesheet">
</head>
<body class="markdown clearness-dark">
<p><strong>NOTE: some content in this wiki applies only to 0.12 and earlier versions. For official documentation on 0.13 and later, see <a href="http://docs.nwjs.io">http://docs.nwjs.io</a></strong></p><p><em>Following content requires node-webkit &gt;= v0.2.5</em></p><p>One important factor of native apps is the ability to make use of native file dialogs. HTML5 does provided limited support for file dialogs, you can put <code>&lt;input type='file' /&gt;</code> and make user click on it and then upload the file to somewhere, that’s not enough for apps on node-webkit, so we extended the <code>input</code> tag.</p><p><strong>You may want to use [[Dragging files into page]] other than opening a file dialog to provide better experiences for some cases.</strong></p><h1 id="differences-between-webkit-and-node-webkit"><a name="differences-between-webkit-and-node-webkit" href="#differences-between-webkit-and-node-webkit"></a>Differences between WebKit and node-webkit</h1><p>In WebKit, certain operations are forbidden in javascript, for example, you can not generate a <code>click</code> event on <code>&lt;input type='file' /&gt;</code>, and you can not set/get real values from it.</p><p>But in node-webkit, these restrictions are removed, and we will use <code>input</code> tag to create file dialogs.</p><p>Another thing is the <code>File</code> object of HTML5’s file API, in WebKit the <code>path</code> attribute is hidden so developers will never know the real paths of files. In node-webkit we made it shown so much things are possible now.</p><h1 id="how-to-open-a-file-dialog"><a name="how-to-open-a-file-dialog" href="#how-to-open-a-file-dialog"></a>How to open a file dialog</h1><p>To create a file dialog, we should first put a <code>input</code> tag on html page and make it hidden:</p><p><em>In order to make examples simple we use jQuery or MooTools for DOM operations</em></p><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
  &amp;lt;script src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
  &amp;lt;!-- OR --&amp;gt;
  &amp;lt;script src=&quot;http://ajax.googleapis.com/ajax/libs/mootools/1.4.5/mootools-yui-compressed.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
  &amp;lt;!-- OR NONE IF YOU ARE USING PURE JAVASCRIPT --&amp;gt;

&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;input style=&quot;display:none;&quot; id=&quot;fileDialog&quot; type=&quot;file&quot; /&amp;gt;
&amp;lt;script&amp;gt;
  // ...
&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
</code></pre>">&lt;html&gt;
&lt;head&gt;
  &lt;script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"&gt;&lt;/script&gt;
  &lt;!-- OR --&gt;
  &lt;script src="http://ajax.googleapis.com/ajax/libs/mootools/1.4.5/mootools-yui-compressed.js"&gt;&lt;/script&gt;
  &lt;!-- OR NONE IF YOU ARE USING PURE JAVASCRIPT --&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;input style="display:none;" id="fileDialog" type="file" /&gt;
&lt;script&gt;
  // ...
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Then we trigger a <code>click</code> event on <code>input</code> tag, and use the <code>change</code> event to capture the file path:</p><h2 id="pure-javascript"><a name="pure-javascript" href="#pure-javascript"></a>Pure JavaScript</h2><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;script&amp;gt;
  function chooseFile(name) {
    var chooser = document.querySelector(name);
    chooser.addEventListener(&quot;change&quot;, function(evt) {
      console.log(this.value);
    }, false);

    chooser.click();  
  }
  chooseFile('#fileDialog');
&amp;lt;/script&amp;gt;
</code></pre>">&lt;script&gt;
  function chooseFile(name) {
    var chooser = document.querySelector(name);
    chooser.addEventListener("change", function(evt) {
      console.log(this.value);
    }, false);

    chooser.click();  
  }
  chooseFile('#fileDialog');
&lt;/script&gt;
</code></pre><h2 id="jquery"><a name="jquery" href="#jquery"></a>jQuery</h2><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;script&amp;gt;
  function chooseFile(name) {
    var chooser = $(name);
    chooser.unbind('change');
    chooser.change(function(evt) {
      console.log($(this).val());
    });

    chooser.trigger('click');  
  }
  chooseFile('#fileDialog');
&amp;lt;/script&amp;gt;
</code></pre>">&lt;script&gt;
  function chooseFile(name) {
    var chooser = $(name);
    chooser.unbind('change');
    chooser.change(function(evt) {
      console.log($(this).val());
    });

    chooser.trigger('click');  
  }
  chooseFile('#fileDialog');
&lt;/script&gt;
</code></pre><h2 id="mootools"><a name="mootools" href="#mootools"></a>MooTools</h2><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;script&amp;gt;
  function chooseFile(name) {
    var chooser = $(name);
    chooser.addEvent(&quot;change&quot;, function() {
      console.log(this.value);
    });

    chooser.click();
  }
  chooseFile('fileDialog');
&amp;lt;/script&amp;gt;
</code></pre>">&lt;script&gt;
  function chooseFile(name) {
    var chooser = $(name);
    chooser.addEvent("change", function() {
      console.log(this.value);
    });

    chooser.click();
  }
  chooseFile('fileDialog');
&lt;/script&gt;
</code></pre><h1 id="other-types-of-dialogs"><a name="other-types-of-dialogs" href="#other-types-of-dialogs"></a>Other types of dialogs</h1><h2 id="multiple"><a name="multiple" href="#multiple"></a>Multiple</h2><p>To make the dialog able to select multiple files, just add a <code>multiple</code> attribute, which is specified in HTML5:</p><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; multiple /&amp;gt;
</code></pre>">&lt;input type="file" multiple /&gt;
</code></pre><p>And the <code>$('#fileDialog').val()</code> will return all selected files’s paths separated with <code>;</code>.</p><h2 id="filter-file"><a name="filter-file" href="#filter-file"></a>Filter File</h2><p>To restrict list of file types dialog accept, just add an <code>accept</code> attribute. <del>Also works for <code>nwsaveas</code> dialogs.</del> Actually not.</p><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; accept=&quot;.doc,.docx,.xml,application/msword&quot;&amp;gt;
</code></pre>">&lt;input type="file" accept=".doc,.docx,.xml,application/msword"&gt;
</code></pre><h2 id="select-directory-(webkit)"><a name="select-directory-(webkit)" href="#select-directory-(webkit)"></a>Select directory (webkit)</h2><p>WebKit also adds a <code>webkitdirectory</code> attribute to show a directory select dialog:</p><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; webkitdirectory /&amp;gt;
</code></pre>">&lt;input type="file" webkitdirectory /&gt;
</code></pre><p>But this attribute is not so useful since the value of <code>input</code> tag is not the path of directory we selected, but paths of all files under the directory.</p><h2 id="select-directory-(node-webkit)"><a name="select-directory-(node-webkit)" href="#select-directory-(node-webkit)"></a>Select directory (node-webkit)</h2><p>In order to provide complete set of file dialogs, node-webkit add another two attributes: <code>nwdirectory</code> and <code>nwsaveas</code>.</p><p><code>nwdirectory</code> is a bit similar to <code>webkitdirectory</code> because it let user select a directory too, but it will not enumerate all files under the directory but directly returns the path of directory, developers may want to use <code>nwdirectory</code> to get the path of a directory:</p><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; nwdirectory /&amp;gt;
</code></pre>">&lt;input type="file" nwdirectory /&gt;
</code></pre><h2 id="save-file"><a name="save-file" href="#save-file"></a>Save file</h2><p><code>nwsaveas</code> will open a ‘save as’ dialog, which lets user enter the path of a file. It’s possible to select a non-existing file, which is different from the default file input tag:</p><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; nwsaveas /&amp;gt;
</code></pre>">&lt;input type="file" nwsaveas /&gt;
</code></pre><p>Starting from v0.7.3 you can specify a value for the default file name to save:</p><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; nwsaveas=&quot;filename.txt&quot; /&amp;gt;
</code></pre>">&lt;input type="file" nwsaveas="filename.txt" /&gt;
</code></pre><h1 id="filelist"><a name="filelist" href="#filelist"></a>FileList</h1><p>Instead of the value of <code>input</code> tag, HTML5 provides a <code>files</code> attribute to return all files selected in a <code>input</code> tag.  The standard usage is:</p><pre><code class="lang-javascript" data-origin="<pre><code class=&quot;lang-javascript&quot;>var files = $('#fileDialog')[0].files;
for (var i = 0; i &amp;lt; files.length; ++i)
  console.log(files[i].name);
</code></pre>">var files = $('#fileDialog')[0].files;
for (var i = 0; i &lt; files.length; ++i)
  console.log(files[i].name);
</code></pre><p>But in normal browser you will not be able to get real paths of files, so in node-webkit an extra <code>path</code> attribute is provided, so you can use this now:</p><pre><code class="lang-javascript" data-origin="<pre><code class=&quot;lang-javascript&quot;>for (var i = 0; i &amp;lt; files.length; ++i)
  console.log(files[i].path);
</code></pre>">for (var i = 0; i &lt; files.length; ++i)
  console.log(files[i].path);
</code></pre><p>If you make use of the <code>fs</code> module with this, you will do magics not possible in browser.</p><h1 id="default-path"><a name="default-path" href="#default-path"></a>Default path</h1><p><em>This feature requires node-webkit &gt;= v0.5.0</em></p><p>Sometimes the application may intelligently suggest where some files might be saved (or loaded) so that its users don’t have to do any manual navigating where such suggestion is correct.</p><p>Such path suggestion is given as a value of yet another custom attribute (<code>nwworkingdir</code>):</p><h3 id="windows"><a name="windows" href="#windows"></a>Windows</h3><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; nwworkingdir=&quot;C:\Windows&quot; /&amp;gt;
</code></pre>">&lt;input type="file" nwworkingdir="C:\Windows" /&gt;
</code></pre><h3 id="unix"><a name="unix" href="#unix"></a>Unix</h3><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;input type=&quot;file&quot; nwworkingdir=&quot;/home/path/&quot; /&amp;gt;
</code></pre>">&lt;input type="file" nwworkingdir="/home/path/" /&gt;
</code></pre><p>The file dialog starts in the given directory when this element is activated.</p><h1 id="choosing-the-same-directory-multiple-times"><a name="choosing-the-same-directory-multiple-times" href="#choosing-the-same-directory-multiple-times"></a>Choosing the same directory multiple times</h1><p>Once the chooser has been used to select a directory (or the same file path + file name), the change event will not fire again since the value of the input is already set with the same value. For example, if a user is expected to select a directory to export a file to, if they choose the same directory multiple times, the change event will only fire once. This is only an issue if the selected value may potentially be the same multiple times, i.e. in the case of selecting an output directory.</p><p>In this case, re-setting the value of the input can ensure that the change event will always fire in subsequent selections.</p><h2 id="jquery"><a name="jquery" href="#jquery"></a>jQuery</h2><pre><code class="lang-html" data-origin="<pre><code class=&quot;lang-html&quot;>&amp;lt;script&amp;gt;
  function chooseFile(name) {
    var chooser = $(name);
    chooser.change(function(evt) {
      console.log($(this).val());
      // Reset the selected value to empty ('')
      $(this).val('');
    });

    chooser.trigger('click');  
  }
  chooseFile('#fileDialog');
&amp;lt;/script&amp;gt;
</code></pre>">&lt;script&gt;
  function chooseFile(name) {
    var chooser = $(name);
    chooser.change(function(evt) {
      console.log($(this).val());
      // Reset the selected value to empty ('')
      $(this).val('');
    });

    chooser.trigger('click');  
  }
  chooseFile('#fileDialog');
&lt;/script&gt;
</code></pre><h1 id="why-not-provide-api-in-javascript"><a name="why-not-provide-api-in-javascript" href="#why-not-provide-api-in-javascript"></a>Why not provide API in javascript</h1><p>We do not provide file dialog API in javascript for following reasons now:</p><ul>
<li>Our way is the standard way of HTML, it will not cause errors if you move to other platforms.</li><li>Better code reusing.</li></ul><p>But if the need is very strong, we will provide it in future.</p>


</body>
</html>
